<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radioactive Decay Simulator</title>
    <style>
        body { font-family: system-ui, sans-serif; background: #1a1a1a; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        canvas { background: #000; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
        .controls { background: #333; padding: 20px; border-radius: 8px; margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 600px; }
        .stat-box { font-size: 1.2rem; font-weight: bold; color: #4af; }
        button { padding: 10px; cursor: pointer; border: none; border-radius: 4px; background: #4af; color: white; font-weight: bold; }
        button:hover { background: #39d; }
        input[type=range] { width: 100%; }
        label { font-size: 0.9rem; color: #ccc; }
    </style>
</head>
<body>

    <h2>Radioactive Decay Simulation</h2>
    
    <div style="display: flex; gap: 20px;">
        <canvas id="decayCanvas" width="400" height="400"></canvas>
        <canvas id="graphCanvas" width="300" height="400"></canvas>
    </div>

    <div class="controls">
        <div>
            <label>Half-Life (Speed of Decay):</label>
            <input type="range" id="halfLifeSlider" min="10" max="500" value="150">
            <div class="stat-box">Atoms Remaining: <span id="atomCount">400</span></div>
        </div>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <button onclick="resetSimulation()">Reset Simulation</button>
            <div id="timeElapsed">Time: 0s</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('decayCanvas');
        const ctx = canvas.getContext('2d');
        const graphCanvas = document.getElementById('graphCanvas');
        const gCtx = graphCanvas.getContext('2d');
        
        let atoms = [];
        const gridSize = 20;
        let halfLife = 150; 
        let time = 0;
        let history = [];

        class Atom {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.decayed = false;
                this.burstFrame = 0;
            }

            draw() {
                if (!this.decayed) {
                    ctx.fillStyle = '#4af';
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 6, 0, Math.PI * 2);
                    ctx.fill();
                } else if (this.burstFrame > 0) {
                    // Draw decay "pop" animation
                    ctx.strokeStyle = `rgba(255, 100, 0, ${this.burstFrame / 10})`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 15 - this.burstFrame, 0, Math.PI * 2);
                    ctx.stroke();
                    this.burstFrame--;
                } else {
                    // Draw stable daughter nucleus
                    ctx.fillStyle = '#555';
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            tryDecay(lambda) {
                if (!this.decayed && Math.random() < lambda) {
                    this.decayed = true;
                    this.burstFrame = 10;
                }
            }
        }

        function resetSimulation() {
            atoms = [];
            history = [];
            time = 0;
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    atoms.push(new Atom(i * 20 + 10, j * 20 + 10));
                }
            }
        }

        function drawGraph() {
            gCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);
            gCtx.strokeStyle = '#4af';
            gCtx.lineWidth = 2;
            gCtx.beginPath();
            gCtx.moveTo(0, 400 - (history[0] || 0));
            history.forEach((count, index) => {
                gCtx.lineTo(index * 2, 400 - count);
            });
            gCtx.stroke();
            
            gCtx.fillStyle = '#ccc';
            gCtx.fillText("Population over Time", 10, 20);
        }

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Calculate decay constant lambda based on slider
            halfLife = document.getElementById('halfLifeSlider').value;
            const lambda = 0.693 / halfLife; 

            let activeCount = 0;
            atoms.forEach(atom => {
                atom.tryDecay(lambda);
                atom.draw();
                if (!atom.decayed) activeCount++;
            });

            document.getElementById('atomCount').innerText = activeCount;
            document.getElementById('timeElapsed').innerText = `Time: ${(time/60).toFixed(1)}s`;
            
            if (time % 5 === 0) history.push(activeCount);
            drawGraph();
            
            time++;
            requestAnimationFrame(update);
        }

        resetSimulation();
        update();
    </script>
</body>
</html>
