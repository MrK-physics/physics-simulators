<!DOCTYPE html>
<html>
<head>
    <title>Nuclear Decay: Timer & Half-Life Control</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; background: #121212; color: #e0e0e0; margin: 0; padding: 20px; }
        canvas { background: #1a1a1a; border: 2px solid #444; border-radius: 12px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .ui { margin: 20px; background: #252525; padding: 25px; border-radius: 10px; border: 1px solid #444; width: 600px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .control-group { display: flex; flex-direction: column; gap: 10px; }
        .stats-group { text-align: right; border-left: 1px solid #444; padding-left: 20px; }
        button { padding: 12px; cursor: pointer; background: #3498db; color: white; border: none; border-radius: 5px; font-weight: bold; }
        button:hover { background: #2980b9; }
        input[type=range] { cursor: pointer; width: 100%; }
        .val { color: #f39c12; font-weight: bold; font-family: monospace; font-size: 1.2em; }
        .legend { grid-column: span 2; display: flex; justify-content: center; gap: 15px; font-size: 0.8em; opacity: 0.7; border-top: 1px solid #333; pt: 10px;}
        .dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; }
    </style>
</head>
<body>

    <h2>Radioactive Decay Laboratory</h2>
    <canvas id="decayCanvas" width="800" height="350"></canvas>
    
    <div class="ui">
        <div class="control-group">
            <label>Half-Life Speed: <span id="halfLifeVal" class="val">Medium</span></label>
            <input type="range" id="speedSlider" min="0.0005" max="0.02" step="0.0005" value="0.004">
            <button onclick="resetSimulation()">Restart Experiment</button>
        </div>

        <div class="stats-group">
            <div>Elapsed Time: <span id="timer" class="val">0.00</span>s</div>
            <div>Remaining Nuclei: <span id="count" class="val">10</span></div>
            <div id="halfLifeMarker" style="font-size: 0.85em; margin-top: 10px; color: #2ecc71;"></div>
        </div>

        <div class="legend">
            <span><span class="dot" style="background:#ff4d4d"></span> Proton</span>
            <span><span class="dot" style="background:#4d79ff"></span> Neutron</span>
            <span><span class="dot" style="background:#f1c40f"></span> Radiation</span>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('decayCanvas');
        const ctx = canvas.getContext('2d');
        const countDisplay = document.getElementById('count');
        const timerDisplay = document.getElementById('timer');
        const speedSlider = document.getElementById('speedSlider');
        const speedLabel = document.getElementById('halfLifeVal');
        const markerDisplay = document.getElementById('halfLifeMarker');
        
        let atoms = [];
        let particles = [];
        let startTime = Date.now();
        let running = true;
        let halfLifeReachedTime = null;

        class Particle {
            constructor(x, y) {
                this.x = x; this.y = y;
                const angle = Math.random() * Math.PI * 2;
                const speed = 5;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                this.life = 1.0;
            }
            update() { this.x += this.vx; this.y += this.vy; this.life -= 0.02; }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(241, 196, 15, ${this.life})`;
                ctx.fill();
            }
        }

        class Atom {
            constructor(x, y) {
                this.x = x; this.y = y;
                this.decayed = false;
                this.nucleons = [];
                for(let i=0; i<12; i++) {
                    this.nucleons.push({
                        relX: (Math.random() - 0.5) * 28,
                        relY: (Math.random() - 0.5) * 28,
                        isProton: Math.random() > 0.5
                    });
                }
            }
            draw() {
                this.nucleons.forEach(n => {
                    ctx.beginPath();
                    ctx.arc(this.x + n.relX, this.y + n.relY, 5, 0, Math.PI * 2);
                    ctx.fillStyle = this.decayed ? "#333" : (n.isProton ? "#ff4d4d" : "#4d79ff");
                    ctx.fill();
                });
            }
        }

        function resetSimulation() {
            atoms = [];
            particles = [];
            startTime = Date.now();
            halfLifeReachedTime = null;
            markerDisplay.innerText = "";
            running = true;
            for (let i = 0; i < 10; i++) {
                atoms.push(new Atom(100 + (i % 5) * 150, 100 + Math.floor(i / 5) * 150));
            }
        }

        function updateSpeedLabel() {
            const val = parseFloat(speedSlider.value);
            if (val < 0.005) speedLabel.innerText = "Long (Slow)";
            else if (val < 0.015) speedLabel.innerText = "Medium";
            else speedLabel.innerText = "Short (Fast)";
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let activeCount = 0;
            
            if (running) {
                const elapsed = ((Date.now() - startTime) / 1000).toFixed(2);
                timerDisplay.innerText = elapsed;
            }

            particles = particles.filter(p => p.life > 0);
            particles.forEach(p => { p.update(); p.draw(); });

            atoms.forEach(atom => {
                if (!atom.decayed) {
                    activeCount++;
                    if (Math.random() < parseFloat(speedSlider.value)) {
                        atom.decayed = true;
                        particles.push(new Particle(atom.x, atom.y));
                        particles.push(new Particle(atom.x, atom.y));
                    }
                }
                atom.draw();
            });

            countDisplay.innerText = activeCount;

            // Check for Half-Life (when count drops to 5)
            if (activeCount <= 5 && !halfLifeReachedTime) {
                halfLifeReachedTime = timerDisplay.innerText;
                markerDisplay.innerText = `TÂ½ (50% Decay) reached at ${halfLifeReachedTime}s`;
            }

            if (activeCount === 0) running = false;
            requestAnimationFrame(animate);
        }

        speedSlider.oninput = updateSpeedLabel;
        resetSimulation();
        updateSpeedLabel();
        animate();
    </script>
</body>
</html>
